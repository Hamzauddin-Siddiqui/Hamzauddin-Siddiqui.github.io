<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  {%- seo -%}
  <link rel="stylesheet" href="{{ "/assets/css/style.css" | relative_url }}">
  {%- feed_meta -%}
  {%- if jekyll.environment == 'production' and site.google_analytics -%}
    {%- include google-analytics.html -%}
  {%- endif -%}

  <script>
    // Simplified theme management with better error handling
    function initializeTheme() {
      if (!document.body) return;
      
      try {
        const savedTheme = localStorage.getItem('theme');
        const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
        
        if (savedTheme === 'dark' || (savedTheme === null && prefersDark)) {
          document.body.classList.add('dark-mode');
        } else {
          document.body.classList.remove('dark-mode');
        }
        
        applyThemeStyles();
      } catch (error) {
        console.log('Theme initialization handled gracefully');
      }
    }

    function toggleTheme() {
      if (!document.body) return;
      
      try {
        const isDark = document.body.classList.contains('dark-mode');
        
        if (isDark) {
          document.body.classList.remove('dark-mode');
          localStorage.setItem('theme', 'light');
        } else {
          document.body.classList.add('dark-mode');
          localStorage.setItem('theme', 'dark');
        }
        
        applyThemeStyles();
      } catch (error) {
        console.log('Theme toggle handled gracefully');
      }
    }

    function applyThemeStyles() {
      if (!document.body) return;
      
      try {
        const isDark = document.body.classList.contains('dark-mode');
        
        if (isDark) {
          document.body.style.backgroundColor = '#1a1a1a';
          document.body.style.color = '#e0e0e0';
        } else {
          document.body.style.backgroundColor = '#ffffff';
          document.body.style.color = '#333333';
        }
        
        // Apply to common elements
        const elements = document.querySelectorAll('h1, h2, h3, h4, h5, h6, p, a, .page-link, .mobile-link');
        elements.forEach(el => {
          if (el && el.style) {
            el.style.color = isDark ? '#e0e0e0' : '#333333';
          }
        });
        
        // Theme toggle buttons
        const toggles = document.querySelectorAll('.theme-toggle');
        toggles.forEach(btn => {
          if (btn && btn.style) {
            btn.style.borderColor = isDark ? '#e0e0e0' : '#333333';
            btn.style.color = isDark ? '#e0e0e0' : '#333333';
          }
        });
        
        // Hamburger lines
        const lines = document.querySelectorAll('.hamburger-line');
        lines.forEach(line => {
          if (line && line.style) {
            line.style.backgroundColor = isDark ? '#e0e0e0' : '#333333';
          }
        });
        
        // Header
        const header = document.querySelector('.site-header');
        if (header && header.style) {
          header.style.backgroundColor = isDark ? '#2d2d2d' : '#f8f9fa';
          header.style.borderBottom = isDark ? '1px solid #444' : '1px solid #e9ecef';
        }
        
        // Mobile menu
        const mobileMenu = document.querySelector('.mobile-menu');
        if (mobileMenu && mobileMenu.style) {
          mobileMenu.style.backgroundColor = isDark ? '#2d2d2d' : '#f8f9fa';
          mobileMenu.style.borderTop = isDark ? '1px solid #444' : '1px solid #e9ecef';
        }
        applyButtonStyles();
      } catch (error) {
        console.log('Theme styles applied with fallback');
      }
    }

    function toggleMobileMenu() {
      try {
        const menu = document.getElementById('mobile-menu');
        const hamburger = document.querySelector('.hamburger');
        
        if (menu && hamburger) {
          menu.classList.toggle('active');
          hamburger.classList.toggle('active');
        }
      } catch (error) {
        console.log('Mobile menu toggle handled gracefully');
      }
    }

    // Safe initialization
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initializeTheme);
    } else {
      initializeTheme();
    }
    
    // Re-apply styles after short delay
    setTimeout(function() {
      applyThemeStyles();
    }, 200);
    // Create profile buttons dynamically
    function createProfileButtons() {
      try {
        const profileContent = document.querySelector('.profile-content');
        
        if (profileContent && !document.querySelector('.profile-buttons')) {
          const buttonContainer = document.createElement('div');
          buttonContainer.className = 'profile-buttons';
          
          // LinkedIn button
          const linkedinBtn = document.createElement('a');
          linkedinBtn.href = 'https://www.linkedin.com/in/hamzauddin-siddiqui-786180175/';
          linkedinBtn.target = '_blank';
          linkedinBtn.className = 'btn-primary';
          linkedinBtn.textContent = 'LinkedIn';
          
          // Download CV button
          const cvBtn = document.createElement('a');
          cvBtn.href = '/Resume - Hamzauddin Siddiqui.pdf';
          cvBtn.target = '_blank';
          cvBtn.className = 'btn-secondary';
          cvBtn.textContent = 'Download CV';
          
          buttonContainer.appendChild(linkedinBtn);
          buttonContainer.appendChild(cvBtn);
          profileContent.appendChild(buttonContainer);
          
          // Apply theme-appropriate styles
          applyButtonStyles();
        }
      } catch (error) {
        console.log('Profile buttons creation handled gracefully');
      }
    }
    
    function applyButtonStyles() {
      const isDark = document.body.classList.contains('dark-mode');
      
      const primaryBtns = document.querySelectorAll('.btn-primary');
      const secondaryBtns = document.querySelectorAll('.btn-secondary');
      
      primaryBtns.forEach(btn => {
        btn.style.backgroundColor = '#0066cc';
        btn.style.color = 'white';
        btn.style.padding = '12px 24px';
        btn.style.borderRadius = '6px';
        btn.style.textDecoration = 'none';
        btn.style.marginRight = '12px';
        btn.style.display = 'inline-block';
        btn.style.transition = 'all 0.3s ease';
      });
      
      secondaryBtns.forEach(btn => {
        btn.style.backgroundColor = isDark ? 'transparent' : 'transparent';
        btn.style.color = isDark ? '#e0e0e0' : '#333333';
        btn.style.border = isDark ? '2px solid #e0e0e0' : '2px solid #333333';
        btn.style.padding = '10px 22px';
        btn.style.borderRadius = '6px';
        btn.style.textDecoration = 'none';
        btn.style.display = 'inline-block';
        btn.style.transition = 'all 0.3s ease';
      });
    }

    // Initialize buttons after DOM loads
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', function() {
        setTimeout(createProfileButtons, 300);
      });
    } else {
      setTimeout(createProfileButtons, 300);
    }
    // Email copy functionality
    function copyEmail() {
      const email = 'hamzauddin54@gmail.com';
      const copyBtn = document.getElementById('copy-btn');
      
      try {
        navigator.clipboard.writeText(email).then(function() {
          copyBtn.textContent = 'Copied!';
          copyBtn.classList.add('copied');
          
          setTimeout(function() {
            copyBtn.textContent = 'Copy';
            copyBtn.classList.remove('copied');
          }, 2000);
        });
      } catch (err) {
        // Fallback for older browsers
        const textArea = document.createElement('textarea');
        textArea.value = email;
        document.body.appendChild(textArea);
        textArea.select();
        document.execCommand('copy');
        document.body.removeChild(textArea);
        
        copyBtn.textContent = 'Copied!';
        copyBtn.classList.add('copied');
        
        setTimeout(function() {
          copyBtn.textContent = 'Copy';
          copyBtn.classList.remove('copied');
        }, 2000);
      }
    }
  </script>
</head>
